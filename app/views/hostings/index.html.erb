<%= render "shared/navbar" %>

<div class="container my-5">
  <h1>Welcome home, <%= current_user.email.match(/^([a-zA-Z0-9._%+-]+)/)%></h1>
</div>
<%# <p>Find me in app/views/hostings/index.html.erb</p> %>

<div class="container my-5">
  <div class="row justify-content-between"> <% @hostings.each do |hosting| %>
    <div class="col-8 py-3">
      <div class="card mb-3 rounded-4">
        <%# <img src="https://www.capitaland.com/en/find-a-property/global-property-listing/residential/the-interlace/_jcr_content/root/container/container/entitydetails.coreimg.85.1600.jpeg/content/dam/capitaland-media-library/residential/Singapore/Singapore/The%20Interlace/Interlace_Woh%20Hup%20and%20CLS.jpg" class="card-img-top" alt="..." style="border-top-left-radius: .25rem; border-top-right-radius: .25rem;"> %>
        <div style="background-image: url('https://www.capitaland.com/en/find-a-property/global-property-listing/residential/the-interlace/_jcr_content/root/container/container/entitydetails.coreimg.85.1600.jpeg/content/dam/capitaland-media-library/residential/Singapore/Singapore/The%20Interlace/Interlace_Woh%20Hup%20and%20CLS.jpg');
          width: 100%;
          background-size: cover;
          background-position: center;
          height: 500px;"
          class="rounded-top-4">
        </div>
        <div class="card-body">
          <h3 class="card-title"><%= hosting.name %></h3>
          <p class="card-text"><%= hosting.location.country_name %></p>
        </div>
      </div>
    </div>
    <div class="col-4 py-3" data-controller="toggle">
      <a href="#" class="btn btn-outline-primary" data-action="click->toggle#fire">Check booking status</a>
      <div>
        <div class="d-none" data-toggle-target="togglableElement">
          <% @bookings.each do |booking| %>
            <div class="card mt-2 rounded-3 p-3" data-controller="booking-status">
              <h5 class="card-title">Name: <%= booking.user.email.match(/^([a-zA-Z0-9._%+-]+)/) %></h5>
              <p class="card-text">Ref: <%= booking.booking_reference %></p>
              <p class="card-text">Check-in: <%= booking.start_date %></p>
              <p class="card-text">Check-out: <%= booking.end_date %></p>
              <p class="card-text" data-booking-status-target="bookingStatus">Status: <%= booking.confirmation_status %></p>
              <%# <%= render "form" %>

              <%= simple_form_for(booking, data: { booking_status_target: "form"}) do |f| %>

                <%= f.input :confirmation_status, collection: ['Pending', 'Confirmed', 'Cancelled'] %>
                <div class="form-actions btn btn-outline-info" data-action= "click->booking-status#send" >
                  <%= f.button :submit %>
                </div>
              <% end %>

            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %></div>
</div>

<%# <%= link_to "Back to Hostings", hostings_path %>
